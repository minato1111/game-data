# ROK Kingdom Data 分析ツール

Rise of Kingdoms ゲームデータの統計・分析を行うWebアプリケーションです。

## 🎉 v3.0 新機能（2025年10月更新）

### ページ分割による大幅な改善
- ✅ **機能ごとにページを分割** - パフォーマンス向上とメンテナンス性向上
- ✅ **独立したURL** - 各ページが独自のURLを持ち、ブックマーク・直接リンク共有が可能
- ✅ **軽量化** - 各ページが必要な機能のみを読み込むため、初期表示が高速化
- ✅ **共通ライブラリ (common.js)** - 重複コードを削減し、保守性向上

### 現在利用可能なページ
1. **index.html** - ホーム/ランディングページ
2. **dataList.html** - データ一覧（検索・フィルター・ページネーション）
3. **kvkList.html** - KVKノルマ一覧（45M以上のプレイヤー対象）
4. **index_old.html** - 統合ページ（旧版）- 成長ランキング、上位300人統計、個人分析、KVKノルマチェッカー

## 🚀 以前の改善点

### セキュリティ強化
- ✅ パスワードをSHA-256ハッシュ化（プレーンテキストから移行）
- ✅ XSS攻撃対策（HTMLエスケープ処理追加）
- ✅ グローバルエラーハンドラー実装
- ✅ Chrome拡張機能エラーの適切な除外

### パフォーマンス最適化
- ✅ DEBUG_MODE=false（本番環境設定）
- ✅ CSVファイルキャッシング（5分間）
- ✅ チャンク処理によるメモリ使用量削減
- ✅ エラー表示件数制限（最大5件）
- ✅ BOM処理の最適化（常時実行）
- ✅ DOM要素キャッシング

### エラーハンドリング改善
- ✅ 詳細なエラーメッセージと解決方法の提示
- ✅ 自動リロード機能付きエラー画面
- ✅ 未処理Promiseエラーのキャッチ
- ✅ 手動CSV解析フォールバック

## 📁 ファイル構成

```
game-data-main/
├── index.html       # ホーム/ランディングページ (v3.0)
├── index_old.html   # 統合ページ（旧版）
├── dataList.html    # データ一覧ページ (v3.0)
├── dataList.js      # データ一覧用JavaScript (v3.0)
├── kvkList.html     # KVKノルマ一覧ページ
├── kvkList.js       # KVKノルマ一覧用JavaScript
├── common.js        # 共通関数ライブラリ (v3.0)
├── script.js        # 旧版用JavaScript
├── styles.css       # スタイルシート（全ページ共通）
├── Master_Data.csv  # プレイヤーデータ
└── README.md        # このファイル
```

## 🔧 技術仕様

### 使用技術
- **HTML5/CSS3/JavaScript (ES6+)**
- **Chart.js** - グラフ表示
- **PapaParse** - CSV解析
- **SHA-256** - パスワードハッシュ化

### ブラウザ要件
- Chrome/Edge/Firefox/Safari（最新版）
- JavaScript有効化必須

## ⚙️ 設定項目

`script.js`内の設定値:

```javascript
const DEBUG_MODE = false;           // 本番: false, 開発: true
const CSV_FILE_PATH = 'Master_Data.csv';
const PERFORMANCE_CONFIG = {
    CACHE_DURATION: 300000,    // 5分キャッシュ
    CHUNK_SIZE: 1000,          // チャンク処理サイズ
    MAX_ERROR_DISPLAY: 5,      // 最大エラー表示数
    PAGINATION_SIZE: 50        // ページネーション
};
```

## 🛡️ セキュリティ

- パスワード認証（ハッシュ化済み）
- XSS攻撃対策
- セッションベース認証

## 📊 機能一覧

1. **データ一覧** - プレイヤー詳細データ表示
2. **成長ランキング** - 期間別成長率分析
3. **上位統計** - 上位300人の統計グラフ
4. **個人分析** - 特定プレイヤーの履歴
5. **KVKノルマ** - Power帯別ノルマ管理
6. **連絡先** - 問い合わせ情報

## 🚀 デプロイ方法

1. 全ファイルをWebサーバーにアップロード
2. `Master_Data.csv`が同じディレクトリにあることを確認
3. ブラウザでアクセス

## 🔍 トラブルシューティング

### CSVファイルが読み込まれない
- ファイルパスを確認
- サーバーの読み込み権限を確認
- ブラウザのキャッシュをクリア

### パスワードが通らない
- 大文字小文字を確認
- 特殊文字の入力を確認

### パフォーマンスが悪い
- `DEBUG_MODE = false`に設定
- ブラウザの開発者ツールでエラー確認

## 📝 更新履歴

**v3.0** (2025年10月14日)
- 🎉 機能ごとにページを分割（パフォーマンス大幅向上）
- ✅ common.js作成（共通関数ライブラリ）
- ✅ dataList.html/js作成（データ一覧ページ独立化）
- ✅ kvkList.html更新（ナビゲーションメニュー追加）
- ✅ index.htmlをランディングページに変更
- ✅ 各ページが独立したURLを持つ（ブックマーク・直接リンク可能）
- ✅ KVKノルマ一覧に45M以上のみ表示するフィルター追加
- ✅ KVKノルマ一覧の列ヘッダーソート機能修正

**v2.1** (2025年10月7日)
- DEBUG_MODE本番環境設定（false）
- BOM処理の最適化と安定化
- Chrome拡張機能エラーの除外処理
- README更新（最新機能反映）

**v2.0** (2024年)
- セキュリティ大幅強化
- パフォーマンス最適化
- エラーハンドリング改善
- 本番環境対応完了

**v1.0** (初期版)
- 基本機能実装
- データ分析機能
- グラフ表示機能