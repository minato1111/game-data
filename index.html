<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROK Kingdom Data 一覧</title>
    <meta name="description" content="Rise of Kingdoms ゲームデータ統計・分析ツール">

    <!-- Favicon設定 -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🏰</text></svg>">
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAdgAAAHYBTnsmCAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANCSURBVFiFtZc9aBRBFMd/s7u5XCQhkVgIFoKFYKOFjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2N">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🏰</text></svg>">

    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js" defer></script>
</head>
<body>
    <!-- パスワード保護画面 -->
    <div id="passwordProtection" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); display: flex; align-items: center; justify-content: center; z-index: 9999;">
        <div style="background: white; padding: 40px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); text-align: center; max-width: 400px; width: 90%;">
            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 28px;">🔒 パスワード認証</h2>
            <p style="color: #7f8c8d; margin-bottom: 30px;">このサイトを閲覧するにはパスワードが必要です</p>
            <input type="password" id="passwordInput" placeholder="パスワードを入力" style="width: 100%; padding: 12px 20px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 16px; margin-bottom: 20px;">
            <button id="loginButton" style="width: 100%; padding: 12px 20px; background: #3498db; color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s;">ログイン</button>
            <div id="passwordError" style="color: #e74c3c; margin-top: 15px; display: none;">パスワードが正しくありません</div>
        </div>
    </div>

    <!-- メインコンテンツ（初期状態では非表示） -->
    <div class="container" id="mainContent" style="display: none;">
        <h1 id="homeTitle" style="cursor: pointer; transition: color 0.3s;" onmouseover="this.style.color='#3498db'" onmouseout="this.style.color='#2c3e50'" title="ホームに戻る">⚔️ ROK Kingdom Data 一覧</h1>
        <div class="subtitle">Rise of Kingdoms - データ統計・分析ツール</div>
        <div class="update-info">
            CSVファイル最終更新: <span id="updateDate">確認中...</span> | 
            データ件数: <span id="dataCount">-</span>件
        </div>
        
        <!-- タブナビゲーション -->
        <nav class="tab-container" role="tablist" aria-label="メインナビゲーション">
            <button class="tab-btn active" onclick="switchTab('data')" role="tab" aria-controls="dataTab" aria-selected="true">データ一覧</button>
            <button class="tab-btn" onclick="switchTab('growth')" role="tab" aria-controls="growthTab" aria-selected="false">成長ランキング</button>
            <button class="tab-btn" onclick="switchTab('overall')" role="tab" aria-controls="overallTab" aria-selected="false">上位300人統計</button>
            <button class="tab-btn" onclick="switchTab('individual')" role="tab" aria-controls="individualTab" aria-selected="false">個人分析</button>
            <button class="tab-btn" onclick="switchTab('kvk')" role="tab" aria-controls="kvkTab" aria-selected="false">KVKノルマ</button>
            <button class="tab-btn" onclick="switchTab('contact')" role="tab" aria-controls="contactTab" aria-selected="false">問い合わせ先</button>
        </nav>

        <!-- データ一覧タブ -->
        <div id="dataTab" class="tab-content active">
            <div class="stats">
                <div class="stat-card">
                    <h3>総レコード数</h3>
                    <p id="totalRecords">読み込み中...</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h3>Power上位300位合計 (最終データ日)</h3>
                    <p id="top300Power">計算中...</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3>最終データ日</h3>
                    <p id="lastUpdate" style="font-size: 16px;">-</p>
                </div>
            </div>

            <!-- 拡張フィルター機能 -->
            <div class="filter-section">
                <div class="date-filter" style="margin-bottom: 15px;">
                    <label style="font-weight: 600;">期間選択:</label>
                    <input type="date" id="dataStartDate">
                    <span>～</span>
                    <input type="date" id="dataEndDate">
                    <button onclick="applyDataFilter()">適用</button>
                    <button class="preset-btn" onclick="setDataPreset('latest')">最新データ</button>
                    <button class="preset-btn" onclick="setDataPreset('week')">直近7日</button>
                    <button class="preset-btn" onclick="setDataPreset('month')">直近30日</button>
                    <button class="preset-btn" onclick="setDataPreset('all')">全期間</button>
                    <button class="clear-btn" onclick="clearDataFilter()">クリア</button>
                </div>

                <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label>指標:</label>
                        <select id="dataMetric" onchange="updateDataDisplay()">
                            <option value="">全て表示</option>
                            <option value="Power">Power</option>
                            <option value="T4-Kills">T4-Kills</option>
                            <option value="T5-Kills">T5-Kills</option>
                            <option value="Total Kill Points">Total Kill Points</option>
                            <option value="Dead Troops">Dead Troops</option>
                            <option value="Troops Power">Troops Power</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label>表示数:</label>
                        <select id="dataLimit" onchange="updateItemsPerPage()">
                            <option value="50">50件</option>
                            <option value="100">100件</option>
                            <option value="300">300件</option>
                            <option value="500">500件</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label>並び順:</label>
                        <select id="dataSortColumn">
                            <option value="">選択してください</option>
                            <option value="Data">日付</option>
                            <option value="ID">ID</option>
                            <option value="Name">名前</option>
                            <option value="Power">Power</option>
                            <option value="Alliance">アライアンス</option>
                            <option value="T4-Kills">T4-Kills</option>
                            <option value="T5-Kills">T5-Kills</option>
                            <option value="Total Kill Points">Total Kill Points</option>
                        </select>
                        <select id="dataSortOrder">
                            <option value="desc">降順</option>
                            <option value="asc">昇順</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="controls">
                <div class="search-box">
                    <label for="searchInput" class="sr-only">検索</label>
                    <input type="text" id="searchInput" placeholder="🔍 名前、ID、同盟で検索..." aria-label="名前、ID、同盟で検索">
                </div>
                <div class="date-range-indicator" id="dateRangeIndicator" style="display: none;">
                    期間: <span id="dateRangeText">-</span>
                </div>
            </div>

            <div class="table-container">
                <table id="dataTable" role="table" aria-label="ROKプレイヤーデータテーブル">
                    <thead>
                        <tr>
                            <th scope="col" style="width: 60px; text-align: center;">No.</th>
                            <th scope="col" class="sortable" data-column="Data" tabindex="0" aria-sort="none">日付</th>
                            <th scope="col" class="sortable" data-column="ID" tabindex="0" aria-sort="none">ID</th>
                            <th scope="col" class="sortable" data-column="Name" tabindex="0" aria-sort="none">名前</th>
                            <th scope="col" class="sortable" data-column="Power" tabindex="0" aria-sort="none">Power</th>
                            <th scope="col" class="sortable" data-column="Alliance" tabindex="0" aria-sort="none">同盟</th>
                            <th scope="col" class="sortable" data-column="T4-Kills" tabindex="0" aria-sort="none">T4-Kills</th>
                            <th scope="col" class="sortable" data-column="T5-Kills" tabindex="0" aria-sort="none">T5-Kills</th>
                            <th scope="col" class="sortable" data-column="Total Kill Points" tabindex="0" aria-sort="none">Total Kill Points</th>
                            <th scope="col" class="sortable" data-column="Dead Troops" tabindex="0" aria-sort="none">Dead Troops</th>
                            <th scope="col" class="sortable" data-column="Troops Power" tabindex="0" aria-sort="none">Troops Power</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr>
                            <td colspan="11" class="loading">
                                <div class="loading-spinner"></div>
                                <p>CSVファイルを読み込み中...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="pagination" id="pagination"></div>
        </div>

        <!-- 成長ランキングタブ -->
        <div id="growthTab" class="tab-content">
            <div class="stats">
                <div class="stat-card" style="background: linear-gradient(135deg, #f39c12 0%, #e74c3c 100%);">
                    <h3>分析期間</h3>
                    <p id="growthPeriodDisplay">未選択</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #27ae60 0%, #16a085 100%);">
                    <h3>分析対象数</h3>
                    <p id="growthAnalysisCount">0</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #8e44ad 0%, #3498db 100%);">
                    <h3>最大成長者</h3>
                    <p id="growthTopPlayer" style="font-size: 16px;">-</p>
                </div>
            </div>

            <!-- 期間選択とフィルター -->
            <div class="filter-section">
                <div class="date-filter" style="margin-bottom: 15px;">
                    <label style="font-weight: 600;">期間選択:</label>
                    <input type="date" id="growthStartDate">
                    <span>～</span>
                    <input type="date" id="growthEndDate">
                    <button onclick="applyGrowthFilter()">適用</button>
                    <button class="preset-btn" onclick="setGrowthPreset('latest')">最新データ</button>
                    <button class="preset-btn" onclick="setGrowthPreset('week')">直近7日</button>
                    <button class="preset-btn" onclick="setGrowthPreset('month')">直近30日</button>
                    <button class="preset-btn" onclick="setGrowthPreset('all')">全期間</button>
                    <button class="clear-btn" onclick="clearGrowthFilter()">クリア</button>
                </div>

                <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">
                    <!-- 表示設定 -->
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label>指標:</label>
                        <select id="growthMetric" onchange="updateGrowthRanking()">
                            <option value="Power">Power</option>
                            <option value="T4-Kills">T4-Kills</option>
                            <option value="T5-Kills">T5-Kills</option>
                            <option value="Total Kill Points">Total Kill Points</option>
                            <option value="Dead Troops">Dead Troops</option>
                            <option value="Troops Power">Troops Power</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label>表示数:</label>
                        <select id="growthLimit" onchange="updateGrowthRanking()">
                            <option value="50">Top 50</option>
                            <option value="100">Top 100</option>
                            <option value="300">Top 300</option>
                            <option value="9999">全員</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label>並び順:</label>
                        <select id="growthSort" onchange="updateGrowthRanking()">
                            <option value="amount">増加量順</option>
                            <option value="rate">成長率順</option>
                            <option value="current">現在値順</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label>フィルター:</label>
                        <select id="growthFilter" onchange="updateGrowthRanking()">
                            <option value="all">全て表示</option>
                            <option value="growth">成長のみ</option>
                            <option value="decline">減少のみ</option>
                        </select>
                    </div>
                </div>

                <!-- 検索機能を追加 -->
                <div style="margin-top: 15px;">
                    <div class="search-box">
                        <input type="text" id="growthSearchInput" placeholder="🔍 名前、ID、同盟で検索..." oninput="filterGrowthBySearch()">
                    </div>
                </div>
            </div>

            <!-- ランキングテーブル -->
            <div class="table-container">
                <table style="width: 100%; border-collapse: collapse; background: white;">
                    <thead style="background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); color: white;">
                        <tr>
                            <th style="padding: 15px; text-align: center; font-weight: 600; position: sticky; top: 0; z-index: 10;">順位</th>
                            <th class="sortable" style="padding: 15px; text-align: center; font-weight: 600; position: sticky; top: 0; z-index: 10; cursor: pointer; user-select: none;" onclick="sortGrowthTable('id')">ID</th>
                            <th class="sortable" style="padding: 15px; text-align: left; font-weight: 600; position: sticky; top: 0; z-index: 10; cursor: pointer; user-select: none;" onclick="sortGrowthTable('name')">名前</th>
                            <th class="sortable" style="padding: 15px; text-align: left; font-weight: 600; position: sticky; top: 0; z-index: 10; cursor: pointer; user-select: none;" onclick="sortGrowthTable('alliance')">同盟</th>
                            <th class="sortable" style="padding: 15px; text-align: right; font-weight: 600; position: sticky; top: 0; z-index: 10; cursor: pointer; user-select: none;" onclick="sortGrowthTable('startValue')">期間開始時</th>
                            <th class="sortable" style="padding: 15px; text-align: right; font-weight: 600; position: sticky; top: 0; z-index: 10; cursor: pointer; user-select: none;" onclick="sortGrowthTable('endValue')">期間終了時</th>
                            <th class="sortable" style="padding: 15px; text-align: right; font-weight: 600; position: sticky; top: 0; z-index: 10; cursor: pointer; user-select: none;" onclick="sortGrowthTable('difference')">増加量</th>
                            <th class="sortable" style="padding: 15px; text-align: right; font-weight: 600; position: sticky; top: 0; z-index: 10; cursor: pointer; user-select: none;" onclick="sortGrowthTable('growthRate')">成長率</th>
                            <th class="sortable" style="padding: 15px; text-align: right; font-weight: 600; position: sticky; top: 0; z-index: 10; cursor: pointer; user-select: none;" onclick="sortGrowthTable('dailyAverage')">日平均</th>
                        </tr>
                    </thead>
                    <tbody id="growthTableBody" style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
                        <tr>
                            <td colspan="9" style="text-align: center; padding: 60px 20px; color: #7f8c8d;">
                                <h3>期間を選択して「適用」をクリックしてください</h3>
                                <p>またはプリセットボタンから期間を選択できます</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 上位300人統計タブ -->
        <div id="overallTab" class="tab-content">
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">上位300人の統計</h2>
                    <div class="chart-controls">
                        <select id="overallMetric">
                            <option value="Power">Power</option>
                            <option value="T4-Kills">T4-Kills</option>
                            <option value="T5-Kills">T5-Kills</option>
                            <option value="Total Kill Points">Total Kill Points</option>
                            <option value="Dead Troops">Dead Troops</option>
                            <option value="Troops Power">Troops Power</option>
                        </select>
                        <button class="active" onclick="showLineChart()">折れ線グラフ</button>
                        <button onclick="showBarChart()">棒グラフ</button>
                    </div>
                </div>

                <div class="chart-wrapper">
                    <canvas id="overallChart"></canvas>
                </div>
                <div class="chart-wrapper" style="display: none;">
                    <canvas id="overallBarChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 個人分析タブ -->
        <div id="individualTab" class="tab-content">
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">個人データ分析</h2>
                    <div class="chart-controls">
                        <input type="text" id="playerSearch" placeholder="プレイヤー名またはIDを入力">
                        <button onclick="searchPlayer()">検索</button>
                    </div>
                </div>
                
                <div id="playerInfo" class="player-info" style="display: none;">
                    <h3 id="playerName">-</h3>
                    <p>ID: <span id="playerId">-</span></p>
                    <p>同盟: <span id="playerAlliance">-</span></p>
                    <p>データ期間: <span id="playerDataRange">-</span></p>
                </div>

                <div class="chart-controls" style="margin: 20px 0;">
                    <select id="individualMetric">
                        <option value="Power">Power</option>
                        <option value="T4-Kills">T4-Kills</option>
                        <option value="T5-Kills">T5-Kills</option>
                        <option value="Total Kill Points">Total Kill Points</option>
                        <option value="Dead Troops">Dead Troops</option>
                        <option value="Troops Power">Troops Power</option>
                    </select>
                    <button onclick="updateIndividualChart()">更新</button>
                </div>

                <div class="chart-wrapper">
                    <canvas id="individualChart"></canvas>
                </div>
                
                <div id="noPlayerData" class="no-data">
                    <h2>プレイヤーを検索してください</h2>
                    <p>上の検索ボックスにプレイヤー名またはIDを入力してください</p>
                </div>
            </div>
        </div>

        <!-- KVKノルマタブ -->
        <div id="kvkTab" class="tab-content">
    <div style="max-width: 1200px; margin: 0 auto; padding: 40px 20px;">
        <!-- ヘッダーセクション -->
        <div style="text-align: center; margin-bottom: 45px;">
            <h2 style="color: #2c3e50; font-size: 34px; margin-bottom: 15px; font-weight: 700;">
                ⚔️ KVKノルマチェッカー
            </h2>
            <p style="color: #7f8c8d; font-size: 16px;">プレイヤーのKVKノルマ達成状況を確認 & Power帯別ノルマ基準値</p>
            <div style="width: 80px; height: 2px; background: #3498db; margin: 15px auto;"></div>
        </div>

        <!-- KVKノルマチェッカーセクション -->
        <div style="margin-bottom: 50px;">
            <!-- プレイヤー検索セクション -->
            <div style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); margin-bottom: 30px;">
                <div style="text-align: center; margin-bottom: 25px;">
                    <h3 style="color: #2c3e50; font-size: 20px; margin-bottom: 10px;">プレイヤー検索</h3>
                    <p style="color: #7f8c8d; font-size: 14px;">プレイヤー名またはIDを入力してKVKノルマの進捗を確認</p>
                </div>

                <div style="display: flex; gap: 15px; align-items: center; justify-content: center; flex-wrap: wrap;">
                    <input type="text" id="kvkPlayerSearch" placeholder="プレイヤー名またはIDを入力"
                           style="padding: 12px 20px; border: 2px solid #e0e0e0; border-radius: 30px; font-size: 16px; min-width: 300px; transition: all 0.3s;"
                           onkeypress="if(event.key==='Enter') searchKvkPlayer()">
                    <button onclick="searchKvkPlayer()"
                            style="padding: 12px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 30px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                        検索
                    </button>
                </div>
            </div>

            <!-- プレイヤー情報表示エリア -->
            <div id="kvkPlayerResult" style="display: none;">
                <!-- プレイヤー基本情報 -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                        <div>
                            <h3 id="kvkPlayerName" style="font-size: 24px; margin-bottom: 5px;">-</h3>
                            <p style="opacity: 0.9;">ID: <span id="kvkPlayerId">-</span> | 同盟: <span id="kvkPlayerAlliance">-</span></p>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 14px; opacity: 0.9;">現在のPower</div>
                            <div id="kvkPlayerPower" style="font-size: 20px; font-weight: 700;">-</div>
                        </div>
                    </div>
                </div>

                <!-- KVKノルマ進捗メーター -->
                <div style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); margin-bottom: 25px;">
                    <h3 style="color: #2c3e50; text-align: center; margin-bottom: 25px; font-size: 20px;">KVKノルマ進捗状況</h3>

                    <!-- 期間表示 -->
                    <div style="text-align: center; margin-bottom: 20px; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                        <span style="color: #7f8c8d; font-size: 14px;">分析期間: <span id="kvkAnalysisPeriod">-</span></span>
                    </div>

                    <!-- 撃破ノルマ進捗 -->
                    <div style="margin-bottom: 30px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="color: #2c3e50; font-size: 16px; margin: 0;">撃破ノルマ (Kill Points)</h4>
                            <span id="kvkKillProgress" style="font-weight: 600; color: #e74c3c;">0 / 0</span>
                        </div>
                        <div style="background: #e0e0e0; border-radius: 10px; height: 20px; overflow: hidden;">
                            <div id="kvkKillProgressBar" style="background: linear-gradient(90deg, #e74c3c 0%, #c0392b 100%); height: 100%; width: 0%; transition: width 0.5s ease; border-radius: 10px; position: relative;">
                                <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: white; font-size: 12px; font-weight: 600;" id="kvkKillPercentage">0%</div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 12px; color: #7f8c8d;">
                            <span>開始時: <span id="kvkKillStart">-</span></span>
                            <span>目標: <span id="kvkKillTarget">-</span></span>
                            <span>現在: <span id="kvkKillCurrent">-</span></span>
                        </div>
                    </div>

                    <!-- 戦死ノルマ進捗 -->
                    <div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="color: #2c3e50; font-size: 16px; margin: 0;">戦死ノルマ (Dead Troops)</h4>
                            <span id="kvkDeathProgress" style="font-weight: 600; color: #f39c12;">0 / 0</span>
                        </div>
                        <div style="background: #e0e0e0; border-radius: 10px; height: 20px; overflow: hidden;">
                            <div id="kvkDeathProgressBar" style="background: linear-gradient(90deg, #f39c12 0%, #e67e22 100%); height: 100%; width: 0%; transition: width 0.5s ease; border-radius: 10px; position: relative;">
                                <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: white; font-size: 12px; font-weight: 600;" id="kvkDeathPercentage">0%</div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 12px; color: #7f8c8d;">
                            <span>開始時: <span id="kvkDeathStart">-</span></span>
                            <span>目標: <span id="kvkDeathTarget">-</span></span>
                            <span>現在: <span id="kvkDeathCurrent">-</span></span>
                        </div>
                    </div>
                </div>

                <!-- ノルマ達成状況サマリー -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); text-align: center;">
                        <div style="font-size: 14px; color: #7f8c8d; margin-bottom: 5px;">撃破ノルマまで</div>
                        <div id="kvkKillRemaining" style="font-size: 20px; font-weight: 700; color: #e74c3c;">-</div>
                        <div id="kvkKillStatus" style="font-size: 12px; margin-top: 5px; padding: 4px 8px; border-radius: 20px; display: inline-block;">-</div>
                    </div>

                    <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); text-align: center;">
                        <div style="font-size: 14px; color: #7f8c8d; margin-bottom: 5px;">戦死ノルマまで</div>
                        <div id="kvkDeathRemaining" style="font-size: 20px; font-weight: 700; color: #f39c12;">-</div>
                        <div id="kvkDeathStatus" style="font-size: 12px; margin-top: 5px; padding: 4px 8px; border-radius: 20px; display: inline-block;">-</div>
                    </div>

                    <div style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); text-align: center;">
                        <div style="font-size: 14px; color: #7f8c8d; margin-bottom: 5px;">総合達成率</div>
                        <div id="kvkOverallProgress" style="font-size: 20px; font-weight: 700; color: #3498db;">-</div>
                        <div id="kvkOverallStatus" style="font-size: 12px; margin-top: 5px; padding: 4px 8px; border-radius: 20px; display: inline-block;">-</div>
                    </div>
                </div>

                <!-- 日次進捗グラフセクション -->
                <div style="margin-top: 30px;">
                    <div style="text-align: center; margin-bottom: 25px;">
                        <h3 style="color: #2c3e50; font-size: 20px; margin-bottom: 10px;">📈 日次進捗グラフ</h3>
                        <p style="color: #7f8c8d; font-size: 14px;">9/22からの撃破数・戦死数の推移</p>
                    </div>

                    <!-- 撃破数グラフ -->
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); margin-bottom: 20px;">
                        <h4 style="color: #2c3e50; text-align: center; margin-bottom: 20px; font-size: 18px;">撃破数 (Kill Points) 推移</h4>
                        <div style="position: relative; height: 300px;">
                            <canvas id="kvkKillChart"></canvas>
                        </div>
                    </div>

                    <!-- 戦死数グラフ -->
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.08);">
                        <h4 style="color: #2c3e50; text-align: center; margin-bottom: 20px; font-size: 18px;">戦死数 (Dead Troops) 推移</h4>
                        <div style="position: relative; height: 300px;">
                            <canvas id="kvkDeathChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 検索前のガイド -->
            <div id="kvkSearchGuide" style="text-align: center; padding: 40px 20px; background: white; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); margin-bottom: 30px;">
                <div style="font-size: 48px; margin-bottom: 15px;">🔍</div>
                <h3 style="color: #2c3e50; margin-bottom: 10px;">プレイヤーを検索してください</h3>
                <p style="color: #7f8c8d; line-height: 1.6; margin-bottom: 20px;">
                    上の検索ボックスにプレイヤー名またはIDを入力して、KVKノルマの達成状況を確認できます
                </p>
                <div style="padding: 15px; background: #e8f4fd; border-radius: 8px; max-width: 400px; margin: 0 auto;">
                    <p style="color: #34495e; font-size: 14px; margin: 0;">💡 9/22からの最新データまでの進捗を自動計算し、Power帯に応じたノルマを判定します</p>
                </div>
            </div>
        </div>

        <!-- ノルマ表セクション -->
        <div>
            <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="color: #2c3e50; font-size: 28px; margin-bottom: 10px; font-weight: 700;">
                    📋 Power帯別ノルマ基準値
                </h2>
                <p style="color: #7f8c8d; font-size: 14px;">各Power帯の撃破ノルマ・戦死ノルマ一覧</p>
            </div>

        <!-- メインノルマテーブル -->
        <div style="background: white; border-radius: 15px; padding: 0; box-shadow: 0 5px 20px rgba(0,0,0,0.08); overflow: hidden; margin-bottom: 40px;">
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);">
                            <th style="padding: 18px 20px; color: white; font-size: 14px; font-weight: 600; text-align: center; min-width: 100px;">
                                Power帯
                            </th>
                            <th style="padding: 18px 20px; color: white; font-size: 14px; font-weight: 600; text-align: center; border-left: 1px solid rgba(255,255,255,0.1);">
                                撃破ノルマ<br><span style="font-size: 11px; opacity: 0.8;">Kill Points</span>
                            </th>
                            <th style="padding: 18px 20px; color: white; font-size: 14px; font-weight: 600; text-align: center; border-left: 1px solid rgba(255,255,255,0.1);">
                                戦死ノルマ<br><span style="font-size: 11px; opacity: 0.8;">Deaths</span>
                            </th>
                            <th style="padding: 18px 20px; color: white; font-size: 14px; font-weight: 600; text-align: center; border-left: 1px solid rgba(255,255,255,0.1);">
                                Death Rate
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #ffffff;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">45M - 59.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">75,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">198,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0033</td>
                        </tr>
                        
                        <tr style="background: #f8f9fa;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">60M - 64.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">150,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">214,500</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0033</td>
                        </tr>
                        
                        <tr style="background: #ffffff;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">65M - 69.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">150,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">231,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0033</td>
                        </tr>
                        
                        <tr style="background: #f8f9fa;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">70M - 74.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">187,500,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">315,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0042</td>
                        </tr>
                        
                        <tr style="background: #ffffff;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">75M - 79.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">187,500,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">336,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0042</td>
                        </tr>
                        
                        <tr style="background: #f8f9fa;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">80M - 84.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">200,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">425,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0050</td>
                        </tr>
                        
                        <tr style="background: #ffffff;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">85M - 89.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">200,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">450,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0050</td>
                        </tr>
                        
                        <tr style="background: #f8f9fa;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">90M - 94.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">300,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">551,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0058</td>
                        </tr>
                        
                        <tr style="background: #ffffff;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">95M - 99.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">300,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">580,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0058</td>
                        </tr>
                        
                        <tr style="background: #f8f9fa;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">100M - 149.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">600,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">1,005,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0067</td>
                        </tr>
                        
                        <tr style="background: #ffffff;">
                            <td style="padding: 16px 20px; text-align: center; font-weight: 600; color: #2c3e50; font-size: 14px;">150M - 199.9M</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #e74c3c; font-size: 18px;">600,000,000</td>
                            <td style="padding: 16px 20px; text-align: center; font-weight: 700; color: #f39c12; font-size: 18px;">1,340,000</td>
                            <td style="padding: 16px 20px; text-align: center; color: #7f8c8d; font-size: 14px;">0.0067</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>


        <!-- 補足説明 -->
        <div style="background: #e8f4fd; border-radius: 10px; padding: 25px; border-left: 4px solid #3498db;">
            <h4 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px; font-weight: 600;">📋 ノルマについて</h4>
            <ul style="color: #34495e; line-height: 1.8; margin: 0; padding-left: 20px;">
                <li style="margin-bottom: 8px;"><strong>Power帯：</strong>プレイヤーの戦力による区分</li>
                <li style="margin-bottom: 8px;"><strong>撃破ノルマ：</strong>KVK期間中に達成すべきKill Points目標</li>
                <li style="margin-bottom: 8px;"><strong>戦死ノルマ：</strong>KVK期間中に達成すべき戦死目標</li>
                <li style="margin-bottom: 8px;"><strong>Death Rate：</strong>Power帯に対する戦死率の基準値</li>
            </ul>
            <div style="margin-top: 20px; padding: 15px; background: #fff9e6; border-radius: 8px;">
                <p style="color: #856404; margin: 0; font-size: 14px;">
                    <strong>⚠️ 注意事項：</strong>これらの数値は参考基準です。実際のKVKでは状況に応じて調整される場合があります。
                </p>
            </div>
        </div>
    </div>
</div>

        <!-- 問い合わせ先タブ -->
        <div id="contactTab" class="tab-content">
            <div style="max-width: 800px; margin: 0 auto; padding: 40px 20px;">
                <!-- ヘッダーセクション -->
                <div style="text-align: center; margin-bottom: 50px;">
                    <h2 style="color: #2c3e50; font-size: 34px; margin-bottom: 15px; font-weight: 700;">
                        📧 問い合わせ先
                    </h2>
                    <p style="color: #7f8c8d; font-size: 16px; line-height: 1.6; max-width: 600px; margin: 0 auto;">
                        ツールに関するご質問、要望、フィードバックなどがございましたら、お気軽にお問い合わせください。
                    </p>
                </div>

                <!-- コンタクト情報 -->
                <div style="display: flex; flex-direction: column; gap: 30px; align-items: center;">

                    <!-- プロフィール画像 -->
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="lJOc64cA_400x400.jpg" alt="プロフィール画像"
                             style="width: 120px; height: 120px; border-radius: 50%; border: 4px solid #3498db; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);">
                    </div>

                    <!-- Twitter -->
                    <div style="background: linear-gradient(135deg, #1da1f2 0%, #1a91da 100%); border-radius: 15px; padding: 25px; width: 100%; max-width: 500px; color: white; text-align: center; box-shadow: 0 10px 25px rgba(29, 161, 242, 0.3); transition: transform 0.3s;"
                         onmouseover="this.style.transform='translateY(-5px)'"
                         onmouseout="this.style.transform='translateY(0)'">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 15px;">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="white">
                                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                            </svg>
                            <h3 style="margin: 0; font-size: 22px; font-weight: 600;">Twitter</h3>
                        </div>
                        <p style="margin: 0 0 15px 0; font-size: 16px; opacity: 0.9;">最新情報やアップデート情報を配信</p>
                        <a href="https://x.com/boo_vazi" target="_blank" rel="noopener noreferrer"
                           style="display: inline-block; background: rgba(255, 255, 255, 0.2); color: white; text-decoration: none; padding: 12px 25px; border-radius: 25px; font-weight: 600; transition: all 0.3s; border: 2px solid rgba(255, 255, 255, 0.3);"
                           onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'; this.style.borderColor='rgba(255, 255, 255, 0.5)'"
                           onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.borderColor='rgba(255, 255, 255, 0.3)'">
                            @boo_vazi をフォロー
                        </a>
                    </div>

                    <!-- Discord -->
                    <div style="background: linear-gradient(135deg, #5865f2 0%, #4752c4 100%); border-radius: 15px; padding: 25px; width: 100%; max-width: 500px; color: white; text-align: center; box-shadow: 0 10px 25px rgba(88, 101, 242, 0.3); transition: transform 0.3s;"
                         onmouseover="this.style.transform='translateY(-5px)'"
                         onmouseout="this.style.transform='translateY(0)'">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 15px;">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="white">
                                <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.010c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418Z"/>
                            </svg>
                            <h3 style="margin: 0; font-size: 22px; font-weight: 600;">Discord</h3>
                        </div>
                        <p style="margin: 0 0 15px 0; font-size: 16px; opacity: 0.9;">リアルタイムでのサポートとコミュニティ</p>
                        <a href="https://discord.gg/Tkh6eUw37x" target="_blank" rel="noopener noreferrer"
                           style="display: inline-block; background: rgba(255, 255, 255, 0.2); color: white; text-decoration: none; padding: 12px 25px; border-radius: 25px; font-weight: 600; transition: all 0.3s; border: 2px solid rgba(255, 255, 255, 0.3);"
                           onmouseover="this.style.background='rgba(255, 255, 255, 0.3)'; this.style.borderColor='rgba(255, 255, 255, 0.5)'"
                           onmouseout="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.borderColor='rgba(255, 255, 255, 0.3)'">
                            サーバーに参加
                        </a>
                    </div>
                </div>

                <!-- 注意事項 -->
                <div style="background: #e8f4fd; border-radius: 15px; padding: 25px; margin-top: 40px; border-left: 4px solid #3498db;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px; font-weight: 600;">📝 お問い合わせ時のお願い</h4>
                    <ul style="color: #34495e; line-height: 1.8; margin: 0; padding-left: 20px;">
                        <li style="margin-bottom: 8px;">具体的な問題の内容や状況をお教えください</li>
                        <li style="margin-bottom: 8px;">エラーが発生した場合は、スクリーンショットも添付していただけると助かります</li>
                        <li style="margin-bottom: 8px;">新機能の要望もお気軽にお寄せください</li>
                        <li style="margin-bottom: 8px;">返信までにお時間をいただく場合がございます</li>
                    </ul>
                </div>
            </div>
        </div>

    </div>

    <script src="script.js" defer></script>

</body>
</html>
