<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROK Kingdom Data - ホーム</title>
    <meta name="description" content="Rise of Kingdoms ゲームデータ統計・分析ツール">

    <!-- Favicon設定 -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🏰</text></svg>">

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="welcome-section" style="text-align: center; margin-bottom: 50px;">
            <h1 style="font-size: 48px; margin-bottom: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                ⚔️ ROK Kingdom Data
            </h1>
            <p style="font-size: 18px; color: #7f8c8d; max-width: 600px; margin: 0 auto;">
                Rise of Kingdoms のプレイヤーデータを統計・分析するための総合ツール
            </p>
        </div>

        <!-- 機能カード -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-bottom: 50px;">
            <!-- データ一覧 -->
            <a href="dataList.html" style="text-decoration: none;">
                <div class="feature-card">
                    <div style="font-size: 48px; margin-bottom: 15px;">📊</div>
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 24px;">データ一覧</h3>
                    <p style="color: #7f8c8d; line-height: 1.6; margin-bottom: 20px;">
                        プレイヤーの詳細データを一覧表示。期間フィルター、検索、ソート機能を搭載。
                    </p>
                    <div class="feature-btn">開く →</div>
                </div>
            </a>

            <!-- KVKノルマ一覧 -->
            <a href="kvkList.html" style="text-decoration: none;">
                <div class="feature-card">
                    <div style="font-size: 48px; margin-bottom: 15px;">📋</div>
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 24px;">KVKノルマ一覧</h3>
                    <p style="color: #7f8c8d; line-height: 1.6; margin-bottom: 20px;">
                        全プレイヤーのKVKノルマ達成状況を一覧表示。Power帯別のノルマ進捗を確認。
                    </p>
                    <div class="feature-btn">開く →</div>
                </div>
            </a>

            <!-- 統合ページ（旧版） -->
            <a href="index_old.html" style="text-decoration: none;">
                <div class="feature-card" style="border: 2px dashed #95a5a6;">
                    <div style="font-size: 48px; margin-bottom: 15px;">🔧</div>
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 24px;">統合ページ（旧版）</h3>
                    <p style="color: #7f8c8d; line-height: 1.6; margin-bottom: 20px;">
                        全機能が統合された旧バージョンのページ。成長ランキング、上位300人統計、個人分析、KVKノルマチェッカーを含む。
                    </p>
                    <div class="feature-btn">開く →</div>
                </div>
            </a>
        </div>

        <!-- 統計概要 -->
        <div class="stats-overview" style="background: rgba(255, 255, 255, 0.95); padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); text-align: center;">
            <h2 style="color: #2c3e50; margin-bottom: 30px; font-size: 32px;">最新情報</h2>

            <div class="quick-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                <div class="quick-stat" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px;">
                    <h4 style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">最終更新</h4>
                    <p id="lastUpdate" style="font-size: 20px; font-weight: bold;">-</p>
                </div>

                <div class="quick-stat" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 15px;">
                    <h4 style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">総データ数</h4>
                    <p id="totalData" style="font-size: 20px; font-weight: bold;">-</p>
                </div>

                <div class="quick-stat" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 15px;">
                    <h4 style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">バージョン</h4>
                    <p style="font-size: 20px; font-weight: bold;">v3.0</p>
                </div>
            </div>

            <div style="margin-top: 30px; padding: 20px; background: #e8f4fd; border-radius: 10px; border-left: 4px solid #3498db;">
                <p style="color: #2c3e50; margin: 0; line-height: 1.6;">
                    <strong>📌 v3.0の新機能:</strong> ページを機能ごとに分割し、パフォーマンスを大幅に向上。各ページが独立したURLを持ち、ブックマークや直接リンク共有が可能になりました。
                </p>
            </div>
        </div>

        <!-- フッター -->
        <div style="text-align: center; margin-top: 40px; padding: 20px; color: #7f8c8d; font-size: 14px;">
            <p>© 2025 ROK Kingdom Data. All rights reserved.</p>
            <p style="margin-top: 10px;">
                <a href="https://github.com/anthropics/claude-code" style="color: #3498db; text-decoration: none;">GitHub</a> |
                <a href="mailto:support@example.com" style="color: #3498db; text-decoration: none;">お問い合わせ</a>
            </p>
        </div>
    </div>

    <script src="common.js"></script>
    <script>
        // 統計情報を取得して表示
        window.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('Master_Data.csv');
                if (response.ok) {
                    const csvText = await response.text();

                    // BOM除去
                    let cleanedText = csvText;
                    if (csvText.charCodeAt(0) === 0xFEFF) {
                        cleanedText = csvText.substring(1);
                    }

                    const parsed = Papa.parse(cleanedText, {
                        header: true,
                        dynamicTyping: true,
                        skipEmptyLines: true
                    });

                    if (parsed && parsed.data && Array.isArray(parsed.data)) {
                        const totalDataElem = document.getElementById('totalData');
                        if (totalDataElem) {
                            totalDataElem.textContent = parsed.data.length.toLocaleString() + ' 件';
                        }

                        // 最終更新日を取得
                        const dates = parsed.data.map(row => row.Data).filter(d => d).sort();
                        const lastDate = dates[dates.length - 1];
                        const lastUpdateElem = document.getElementById('lastUpdate');
                        if (lastUpdateElem && lastDate) {
                            lastUpdateElem.textContent = lastDate;
                        }
                    }
                }
            } catch (error) {
                console.error('統計情報取得エラー:', error);
            }
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</body>
</html>
